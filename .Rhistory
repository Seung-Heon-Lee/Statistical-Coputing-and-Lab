+ bearing[Direct<=292.5 & Direct>=247.6] = Direct_level[7]
+ bearing[Direct<=337.5 & Direct>=292.6] = Direct_level[8]
+ bearing[Direct<=360.0 & Direct>=337.6] = Direct_level[1]
+ bearing = factor(bearing, level = Direct_level)
})
Direct_level <- c("N", "NE", "E", "SE", "S", "SW", "W", "NW")
heat_island_data <- within(heat_island_data , {bearing = character(0)
+ bearing[Direct<=22.5 & Direct>=0.1] = Direct_level[1]
+ bearing[Direct<=67.5 & Direct>=22.6] = Direct_level[2]
+ bearing[Direct<=112.5 & Direct>=67.6] = Direct_level[3]
+ bearing[Direct<=157.5 & Direct>=112.6] = Direct_level[4]
+ bearing[Direct<=202.5 & Direct>=157.6] = Direct_level[5]
+ bearing[Direct<=247.5 & Direct>=202.6] = Direct_level[6]
+ bearing[Direct<=292.5 & Direct>=247.6] = Direct_level[7]
+ bearing[Direct<=337.5 & Direct>=292.6] = Direct_level[8]
+ bearing[Direct<=360.0 & Direct>=337.6] = Direct_level[1]
+ bearing = factor(bearing, level = Direct_level)
})
Direct_level <- c("N", "NE", "E", "SE", "S", "SW", "W", "NW")
heat_island_data <- within(heat_island_data , {bearing = character(0)
, bearing[Direct<=22.5 & Direct>=0.1] = Direct_level[1]
, bearing[Direct<=67.5 & Direct>=22.6] = Direct_level[2]
, bearing[Direct<=112.5 & Direct>=67.6] = Direct_level[3]
, bearing[Direct<=157.5 & Direct>=112.6] = Direct_level[4]
, bearing[Direct<=202.5 & Direct>=157.6] = Direct_level[5]
, bearing[Direct<=247.5 & Direct>=202.6] = Direct_level[6]
, bearing[Direct<=292.5 & Direct>=247.6] = Direct_level[7]
, bearing[Direct<=337.5 & Direct>=292.6] = Direct_level[8]
, bearing[Direct<=360.0 & Direct>=337.6] = Direct_level[1]
, bearing = factor(bearing, level = Direct_level)
})
Direct_level <- c("N", "NE", "E", "SE", "S", "SW", "W", "NW")
heat_island_data <- within(heat_island_data , {bearing = character(0)
bearing[Direct<=22.5 & Direct>=0.1] = Direct_level[1]
bearing[Direct<=67.5 & Direct>=22.6] = Direct_level[2]
bearing[Direct<=112.5 & Direct>=67.6] = Direct_level[3]
bearing[Direct<=157.5 & Direct>=112.6] = Direct_level[4]
bearing[Direct<=202.5 & Direct>=157.6] = Direct_level[5]
bearing[Direct<=247.5 & Direct>=202.6] = Direct_level[6]
bearing[Direct<=292.5 & Direct>=247.6] = Direct_level[7]
bearing[Direct<=337.5 & Direct>=292.6] = Direct_level[8]
bearing[Direct<=360.0 & Direct>=337.6] = Direct_level[1]
bearing = factor(bearing, level = Direct_level)
})
Direct_level <- c("N", "NE", "E", "SE", "S", "SW", "W", "NW")
PM10_bearing <- within(PM10_direct, {bearing = character(0)
bearing[Direct<=22.5 & Direct>=0.1] = Direct_level[1]
bearing[Direct<=67.5 & Direct>=22.6] = Direct_level[2]
bearing[Direct<=112.5 & Direct>=67.6] = Direct_level[3]
bearing[Direct<=157.5 & Direct>=112.6] = Direct_level[4]
bearing[Direct<=202.5 & Direct>=157.6] = Direct_level[5]
bearing[Direct<=247.5 & Direct>=202.6] = Direct_level[6]
bearing[Direct<=292.5 & Direct>=247.6] = Direct_level[7]
bearing[Direct<=337.5 & Direct>=292.6] = Direct_level[8]
bearing[Direct<=360.0 & Direct>=337.6] = Direct_level[1]
bearing = factor(bearing, level = Direct_level)
})
Direct_level <- c("N", "NE", "E", "SE", "S", "SW", "W", "NW")
PM10_bearing <- within(PM10_direct, {bearing = character(0)
bearing[Direct<=22.5 & Direct>=0.1] = Direct_level[1]
bearing[Direct<=67.5 & Direct>=22.6] = Direct_level[2]
bearing[Direct<=112.5 & Direct>=67.6] = Direct_level[3]
bearing[Direct<=157.5 & Direct>=112.6] = Direct_level[4]
bearing[Direct<=202.5 & Direct>=157.6] = Direct_level[5]
bearing[Direct<=247.5 & Direct>=202.6] = Direct_level[6]
bearing[Direct<=292.5 & Direct>=247.6] = Direct_level[7]
bearing[Direct<=337.5 & Direct>=292.6] = Direct_level[8]
bearing[Direct<=360.0 & Direct>=337.6] = Direct_level[1]
bearing = factor(bearing, level = Direct_level)
})
PM10_bearing
Direct_level <- c("N", "NE", "E", "SE", "S", "SW", "W", "NW")
PM10_bearing <- within(PM10_direct, {bearing = character(0)
bearing[Direct<=22.5 & Direct>=0.1] = Direct_level[1]
bearing[Direct<=67.5 & Direct>=22.6] = Direct_level[2]
bearing[Direct<=112.5 & Direct>=67.6] = Direct_level[3]
bearing[Direct<=157.5 & Direct>=112.6] = Direct_level[4]
bearing[Direct<=202.5 & Direct>=157.6] = Direct_level[5]
bearing[Direct<=247.5 & Direct>=202.6] = Direct_level[6]
bearing[Direct<=292.5 & Direct>=247.6] = Direct_level[7]
bearing[Direct<=337.5 & Direct>=292.6] = Direct_level[8]
bearing[Direct<=360.0 & Direct>=337.6] = Direct_level[1]
bearing = factor(bearing, level = Direct_level)
})
PM2.5_bearing <- within(PM2.5_direct, {bearing = character(0)
bearing[Direct<=22.5 & Direct>=0.1] = Direct_level[1]
bearing[Direct<=67.5 & Direct>=22.6] = Direct_level[2]
bearing[Direct<=112.5 & Direct>=67.6] = Direct_level[3]
bearing[Direct<=157.5 & Direct>=112.6] = Direct_level[4]
bearing[Direct<=202.5 & Direct>=157.6] = Direct_level[5]
bearing[Direct<=247.5 & Direct>=202.6] = Direct_level[6]
bearing[Direct<=292.5 & Direct>=247.6] = Direct_level[7]
bearing[Direct<=337.5 & Direct>=292.6] = Direct_level[8]
bearing[Direct<=360.0 & Direct>=337.6] = Direct_level[1]
bearing = factor(bearing, level = Direct_level)
})
PM10_bearing %>% mutate(Direct = bearing)
PM2.5_bearing
Direct_level <- c("N", "NE", "E", "SE", "S", "SW", "W", "NW")
PM10_bearing <- within(PM10_direct, {bearing = character(0)
bearing[Direct<=22.5 & Direct>=0.1] = Direct_level[1]
bearing[Direct<=67.5 & Direct>=22.6] = Direct_level[2]
bearing[Direct<=112.5 & Direct>=67.6] = Direct_level[3]
bearing[Direct<=157.5 & Direct>=112.6] = Direct_level[4]
bearing[Direct<=202.5 & Direct>=157.6] = Direct_level[5]
bearing[Direct<=247.5 & Direct>=202.6] = Direct_level[6]
bearing[Direct<=292.5 & Direct>=247.6] = Direct_level[7]
bearing[Direct<=337.5 & Direct>=292.6] = Direct_level[8]
bearing[Direct<=360.0 & Direct>=337.6] = Direct_level[1]
bearing = factor(bearing, level = Direct_level)
})
PM2.5_bearing <- within(PM2.5_direct, {bearing = character(0)
bearing[Direct<=22.5 & Direct>=0.1] = Direct_level[1]
bearing[Direct<=67.5 & Direct>=22.6] = Direct_level[2]
bearing[Direct<=112.5 & Direct>=67.6] = Direct_level[3]
bearing[Direct<=157.5 & Direct>=112.6] = Direct_level[4]
bearing[Direct<=202.5 & Direct>=157.6] = Direct_level[5]
bearing[Direct<=247.5 & Direct>=202.6] = Direct_level[6]
bearing[Direct<=292.5 & Direct>=247.6] = Direct_level[7]
bearing[Direct<=337.5 & Direct>=292.6] = Direct_level[8]
bearing[Direct<=360.0 & Direct>=337.6] = Direct_level[1]
bearing = factor(bearing, level = Direct_level)
})
PM10_bearing %>% transmutate(Direct = bearing)
PM2.5_bearing
Direct_level <- c("N", "NE", "E", "SE", "S", "SW", "W", "NW")
PM10_bearing <- within(PM10_direct, {bearing = character(0)
bearing[Direct<=22.5 & Direct>=0.1] = Direct_level[1]
bearing[Direct<=67.5 & Direct>=22.6] = Direct_level[2]
bearing[Direct<=112.5 & Direct>=67.6] = Direct_level[3]
bearing[Direct<=157.5 & Direct>=112.6] = Direct_level[4]
bearing[Direct<=202.5 & Direct>=157.6] = Direct_level[5]
bearing[Direct<=247.5 & Direct>=202.6] = Direct_level[6]
bearing[Direct<=292.5 & Direct>=247.6] = Direct_level[7]
bearing[Direct<=337.5 & Direct>=292.6] = Direct_level[8]
bearing[Direct<=360.0 & Direct>=337.6] = Direct_level[1]
bearing = factor(bearing, level = Direct_level)
})
PM2.5_bearing <- within(PM2.5_direct, {bearing = character(0)
bearing[Direct<=22.5 & Direct>=0.1] = Direct_level[1]
bearing[Direct<=67.5 & Direct>=22.6] = Direct_level[2]
bearing[Direct<=112.5 & Direct>=67.6] = Direct_level[3]
bearing[Direct<=157.5 & Direct>=112.6] = Direct_level[4]
bearing[Direct<=202.5 & Direct>=157.6] = Direct_level[5]
bearing[Direct<=247.5 & Direct>=202.6] = Direct_level[6]
bearing[Direct<=292.5 & Direct>=247.6] = Direct_level[7]
bearing[Direct<=337.5 & Direct>=292.6] = Direct_level[8]
bearing[Direct<=360.0 & Direct>=337.6] = Direct_level[1]
bearing = factor(bearing, level = Direct_level)
})
PM10_bearing %>% transmute(Direct = bearing)
PM2.5_bearing
Direct_level <- c("N", "NE", "E", "SE", "S", "SW", "W", "NW")
PM10_bearing <- within(PM10_direct, {bearing = character(0)
bearing[Direct<=22.5 & Direct>=0.1] = Direct_level[1]
bearing[Direct<=67.5 & Direct>=22.6] = Direct_level[2]
bearing[Direct<=112.5 & Direct>=67.6] = Direct_level[3]
bearing[Direct<=157.5 & Direct>=112.6] = Direct_level[4]
bearing[Direct<=202.5 & Direct>=157.6] = Direct_level[5]
bearing[Direct<=247.5 & Direct>=202.6] = Direct_level[6]
bearing[Direct<=292.5 & Direct>=247.6] = Direct_level[7]
bearing[Direct<=337.5 & Direct>=292.6] = Direct_level[8]
bearing[Direct<=360.0 & Direct>=337.6] = Direct_level[1]
bearing = factor(bearing, level = Direct_level)
})
PM2.5_bearing <- within(PM2.5_direct, {bearing = character(0)
bearing[Direct<=22.5 & Direct>=0.1] = Direct_level[1]
bearing[Direct<=67.5 & Direct>=22.6] = Direct_level[2]
bearing[Direct<=112.5 & Direct>=67.6] = Direct_level[3]
bearing[Direct<=157.5 & Direct>=112.6] = Direct_level[4]
bearing[Direct<=202.5 & Direct>=157.6] = Direct_level[5]
bearing[Direct<=247.5 & Direct>=202.6] = Direct_level[6]
bearing[Direct<=292.5 & Direct>=247.6] = Direct_level[7]
bearing[Direct<=337.5 & Direct>=292.6] = Direct_level[8]
bearing[Direct<=360.0 & Direct>=337.6] = Direct_level[1]
bearing = factor(bearing, level = Direct_level)
})
PM10_bearing %>% transmute(Direct = bearing)
PM2.5_bearing %>% transmute(Direct = bearing)
Direct_level <- c("N", "NE", "E", "SE", "S", "SW", "W", "NW")
PM10_bearing <- within(PM10_direct, {bearing = character(0)
bearing[Direct<=22.5 & Direct>=0.1] = Direct_level[1]
bearing[Direct<=67.5 & Direct>=22.6] = Direct_level[2]
bearing[Direct<=112.5 & Direct>=67.6] = Direct_level[3]
bearing[Direct<=157.5 & Direct>=112.6] = Direct_level[4]
bearing[Direct<=202.5 & Direct>=157.6] = Direct_level[5]
bearing[Direct<=247.5 & Direct>=202.6] = Direct_level[6]
bearing[Direct<=292.5 & Direct>=247.6] = Direct_level[7]
bearing[Direct<=337.5 & Direct>=292.6] = Direct_level[8]
bearing[Direct<=360.0 & Direct>=337.6] = Direct_level[1]
bearing = factor(bearing, level = Direct_level)
})
PM2.5_bearing <- within(PM2.5_direct, {bearing = character(0)
bearing[Direct<=22.5 & Direct>=0.1] = Direct_level[1]
bearing[Direct<=67.5 & Direct>=22.6] = Direct_level[2]
bearing[Direct<=112.5 & Direct>=67.6] = Direct_level[3]
bearing[Direct<=157.5 & Direct>=112.6] = Direct_level[4]
bearing[Direct<=202.5 & Direct>=157.6] = Direct_level[5]
bearing[Direct<=247.5 & Direct>=202.6] = Direct_level[6]
bearing[Direct<=292.5 & Direct>=247.6] = Direct_level[7]
bearing[Direct<=337.5 & Direct>=292.6] = Direct_level[8]
bearing[Direct<=360.0 & Direct>=337.6] = Direct_level[1]
bearing = factor(bearing, level = Direct_level)
})
PM10_bearing <- PM10_bearing %>% transmute(Direct = bearing)
PM10_bearing <- PM2.5_bearing %>% transmute(Direct = bearing)
summary(PM10_bearing)
PM10_bearing %>% mutate(ratio = Direct/nrow(PM10_bearing) )
PM10_bearing %>% group_by(Direct) %>% n()
PM10_bearing %>% group_by(Direct) %>% summarise(n())
PM10_bearing %>% group_by(Direct) %>% summarise(n()) %>% mutate(ratio = `n()`/sum(`n()`))
PM10_bearing_ratio <- PM10_bearing %>% group_by(Direct) %>% summarise(n()) %>% mutate(ratio = `n()`/sum(`n()`))
sum(PM10_bearing_ratio$ratio)
PM10_bearing_ratio <- PM10_bearing %>% group_by(Direct) %>% summarise(n()) %>% mutate(ratio = `n()`/sum(`n()`))
PM2.5_bearing_ratio <- PM2.5_bearing %>% group_by(Direct) %>% summarise(n()) %>% mutate(ratio = `n()`/sum(`n()`))
PM10_bearing_ratio <- PM10_bearing %>% group_by(Direct) %>% summarise(n()) %>% mutate(ratio_10 = `n()`/sum(`n()`))
PM2.5_bearing_ratio <- PM2.5_bearing %>% group_by(Direct) %>% summarise(n()) %>% mutate(ratio_2.5 = `n()`/sum(`n()`))
PM10_bearing_ratio <- PM10_bearing %>% group_by(Direct) %>% summarise(n()) %>% mutate(ratio_10 = `n()`/sum(`n()`))
PM2.5_bearing_ratio <- PM2.5_bearing %>% group_by(Direct) %>% summarise(n()) %>% mutate(ratio_2.5 = `n()`/sum(`n()`))
PM10_bearing_ratio
PM2.5_bearing_ratio
Direct_level <- c("N", "NE", "E", "SE", "S", "SW", "W", "NW")
PM10_bearing <- within(PM10_direct, {bearing = character(0)
bearing[Direct<=22.5 & Direct>=0.1] = Direct_level[1]
bearing[Direct<=67.5 & Direct>=22.6] = Direct_level[2]
bearing[Direct<=112.5 & Direct>=67.6] = Direct_level[3]
bearing[Direct<=157.5 & Direct>=112.6] = Direct_level[4]
bearing[Direct<=202.5 & Direct>=157.6] = Direct_level[5]
bearing[Direct<=247.5 & Direct>=202.6] = Direct_level[6]
bearing[Direct<=292.5 & Direct>=247.6] = Direct_level[7]
bearing[Direct<=337.5 & Direct>=292.6] = Direct_level[8]
bearing[Direct<=360.0 & Direct>=337.6] = Direct_level[1]
bearing = factor(bearing, level = Direct_level)
})
PM2.5_bearing <- within(PM2.5_direct, {bearing = character(0)
bearing[Direct<=22.5 & Direct>=0.1] = Direct_level[1]
bearing[Direct<=67.5 & Direct>=22.6] = Direct_level[2]
bearing[Direct<=112.5 & Direct>=67.6] = Direct_level[3]
bearing[Direct<=157.5 & Direct>=112.6] = Direct_level[4]
bearing[Direct<=202.5 & Direct>=157.6] = Direct_level[5]
bearing[Direct<=247.5 & Direct>=202.6] = Direct_level[6]
bearing[Direct<=292.5 & Direct>=247.6] = Direct_level[7]
bearing[Direct<=337.5 & Direct>=292.6] = Direct_level[8]
bearing[Direct<=360.0 & Direct>=337.6] = Direct_level[1]
bearing = factor(bearing, level = Direct_level)
})
PM10_bearing <- PM10_bearing %>% transmute(Direct = bearing)
PM2.5_bearing <- PM2.5_bearing %>% transmute(Direct = bearing)
PM10_bearing_ratio <- PM10_bearing %>% group_by(Direct) %>% summarise(n()) %>% mutate(ratio_10 = `n()`/sum(`n()`))
PM2.5_bearing_ratio <- PM2.5_bearing %>% group_by(Direct) %>% summarise(n()) %>% mutate(ratio_2.5 = `n()`/sum(`n()`))
PM10_bearing_ratio
PM2.5_bearing_ratio
PM10_bearing_ratio <- PM10_bearing %>% group_by(Direct) %>% summarise(n()) %>% mutate(ratio_10 = `n()`/sum(`n()`)) %>% dplyr::select(-`n()`)
PM2.5_bearing_ratio <- PM2.5_bearing %>% group_by(Direct) %>% summarise(n()) %>% mutate(ratio_2.5 = `n()`/sum(`n()`))  %>% dplyr::select(-`n()`)
PM10_bearing_ratio
PM2.5_bearing_ratio
PM10_bearing_ratio <- PM10_bearing %>% group_by(Direct) %>% summarise(n()) %>% mutate(ratio_10 = `n()`/sum(`n()`)) %>% dplyr::select(-`n()`)
PM2.5_bearing_ratio <- PM2.5_bearing %>% group_by(Direct) %>% summarise(n()) %>% mutate(ratio_2.5 = `n()`/sum(`n()`))  %>% dplyr::select(-`n()`)
PM10_bearing_ratio
PM2.5_bearing_ratio
inner_join(PM10_bearing_ratio, PM2.5_bearing_ratio)
ggplot(data = bearing ) + geom_polygon(aes(Direct,ratio_10)) + geom_polygon(aes(Direct,ratio_2.5))
PM10_bearing_ratio <- PM10_bearing %>% group_by(Direct) %>% summarise(n()) %>% mutate(ratio_10 = `n()`/sum(`n()`)) %>% dplyr::select(-`n()`)
PM2.5_bearing_ratio <- PM2.5_bearing %>% group_by(Direct) %>% summarise(n()) %>% mutate(ratio_2.5 = `n()`/sum(`n()`))  %>% dplyr::select(-`n()`)
PM10_bearing_ratio
PM2.5_bearing_ratio
bearing <- inner_join(PM10_bearing_ratio, PM2.5_bearing_ratio)
ggplot(data = bearing ) + geom_polygon(aes(Direct,ratio_10)) + geom_polygon(aes(Direct,ratio_2.5))
ggplot(data = bearing ) + geom_polygon(aes(Direct,ratio_10), size =2) + geom_polygon(aes(Direct,ratio_2.5), size =2)
ggplot(data = bearing ) + geom_line(aes(Direct,ratio_10), size =2) + geom_polygon(aes(Direct,ratio_2.5), size =2)
ggplot(data = bearing ) + geom_ploygon(aes(Direct,ratio_10), size =2) + geom_polygon(aes(Direct,ratio_2.5), size =2)
ggplot(data = bearing ) + geom_polygon(aes(Direct,ratio_10), size =2) + geom_polygon(aes(Direct,ratio_2.5), size =2)
heat_island_data <- joined_data %>% filter(!is.na(Temper), !is.na(PM10), !is.na(PM2.5)) %>% filter(month(Measurement_date)<=2 | month(Measurement_date) == 12 ) %>% filter(hour(Measurement_date)>=3, hour(Measurement_date)<=9)
heat_island_data <- joined_data %>% filter(!is.na(Temper), !is.na(PM10), !is.na(PM2.5)) %>% filter(month(Measurement_date)<=2 | month(Measurement_date) == 12 ) %>% filter(hour(Measurement_date)>=3, hour(Measurement_date)<=9)
heat_island_data
heat_island_data <- joined_data %>% filter(!is.na(Temper), !is.na(PM10), !is.na(PM2.5)) %>% filter(month(Measurement_date)<=2 | month(Measurement_date) == 12 ) %>% filter(hour(Measurement_date)>=3, hour(Measurement_date)<=9) %>% mutate(hour = hour(Measurement_date))
heat_island_data
heat_island_data %>% group_by(hour, District) %>% summarise(mean(Temper, PM10))
heat_island_data %>% group_by(hour, District) %>% summarise(mean(Temper))
heat_island_data %>% group_by(hour, District) %>% summarise(mean(Temper), mean(PM10))
heat_island_data %>% group_by(hour, District) %>% summarise(mean(Temper), mean(PM10), mean(PM2.5), sd(Temper), sd(PM10), sd(PM2.5))
ggplot(data = bearing ) + geom_polygon(aes(group=Direct,ratio_10), size =2) + geom_polygon(aes(group = Direct,ratio_2.5), size =2)
ggplot(data = bearing ) + geom_polygon(aes(group=Direct,fill=ratio_10), size =2) + geom_polygon(aes(group = Direct,fill=ratio_2.5), size =2)
PM10_bearing_ratio <- PM10_bearing %>% group_by(Direct) %>% summarise(n()) %>% mutate(ratio_10 = `n()`/sum(`n()`)) %>% dplyr::select(-`n()`)
PM2.5_bearing_ratio <- PM2.5_bearing %>% group_by(Direct) %>% summarise(n()) %>% mutate(ratio_2.5 = `n()`/sum(`n()`))  %>% dplyr::select(-`n()`)
PM10_bearing_ratio
PM2.5_bearing_ratio
bearing <- inner_join(PM10_bearing_ratio, PM2.5_bearing_ratio)
bearing
ggplot(data = bearing ) + geom_point(aes(Direct, ratio_10)) + coord_polar() + geom_polygon()
ggplot(data = bearing ) + geom_point(aes(Direct, ratio_10)) + coord_polar() + geom_polygon(aes(group=Direct))
PM10_bearing_ratio <- PM10_bearing %>% group_by(Direct) %>% summarise(n()) %>% mutate(ratio = `n()`/sum(`n()`)) %>% dplyr::select(-`n()`)
PM2.5_bearing_ratio <- PM2.5_bearing %>% group_by(Direct) %>% summarise(n()) %>% mutate(ratio = `n()`/sum(`n()`))  %>% dplyr::select(-`n()`)
PM10_bearing_ratio
PM2.5_bearing_ratio
PM10_bearing_ratio <- PM10_bearing %>% group_by(Direct) %>% summarise(n()) %>% mutate(ratio = `n()`/sum(`n()`)) %>% dplyr::select(-`n()`) %>% mutate(item = "PM10")
PM2.5_bearing_ratio <- PM2.5_bearing %>% group_by(Direct) %>% summarise(n()) %>% mutate(ratio = `n()`/sum(`n()`))  %>% dplyr::select(-`n()`) %>% mutate(item = "PM2.5")
PM10_bearing_ratio
PM2.5_bearing_ratio
PM10_bearing_ratio <- PM10_bearing %>% group_by(Direct) %>% summarise(n()) %>% mutate(ratio = `n()`/sum(`n()`)) %>% dplyr::select(-`n()`) %>% mutate(item = "PM10")
PM2.5_bearing_ratio <- PM2.5_bearing %>% group_by(Direct) %>% summarise(n()) %>% mutate(ratio = `n()`/sum(`n()`))  %>% dplyr::select(-`n()`) %>% mutate(item = "PM2.5")
PM10_bearing_ratio
PM2.5_bearing_ratio
rbind(PM10_bearing_ratio, PM2.5_bearing_ratio)
PM10_bearing_ratio <- PM10_bearing %>% group_by(Direct) %>% summarise(n()) %>% mutate(ratio = `n()`/sum(`n()`)) %>% dplyr::select(-`n()`) %>% mutate(item = "PM10")
PM2.5_bearing_ratio <- PM2.5_bearing %>% group_by(Direct) %>% summarise(n()) %>% mutate(ratio = `n()`/sum(`n()`))  %>% dplyr::select(-`n()`) %>% mutate(item = "PM2.5")
PM10_bearing_ratio
PM2.5_bearing_ratio
bearing_ratio <- rbind(PM10_bearing_ratio, PM2.5_bearing_ratio)
PM10_bearing_ratio <- PM10_bearing %>% group_by(Direct) %>% summarise(n()) %>% mutate(ratio = `n()`/sum(`n()`)) %>% dplyr::select(-`n()`) %>% mutate(item = "PM10")
PM2.5_bearing_ratio <- PM2.5_bearing %>% group_by(Direct) %>% summarise(n()) %>% mutate(ratio = `n()`/sum(`n()`))  %>% dplyr::select(-`n()`) %>% mutate(item = "PM2.5")
PM10_bearing_ratio
PM2.5_bearing_ratio
bearing_ratio <- rbind(PM10_bearing_ratio, PM2.5_bearing_ratio)
ggplot(data = bearing ) + geom_point(aes(Direct, ratio)) + coord_polar() + geom_polygon(group = item)
ggplot(data = bearing_ratio ) + geom_point(aes(Direct, ratio)) + coord_polar() + geom_polygon(group = item)
ggplot(data = bearing_ratio ) + geom_point(aes(Direct, ratio)) + coord_polar() + geom_polygon(group = "item")
ggplot(data = bearing_ratio ) + geom_point(aes(Direct, ratio)) + coord_polar() + geom_polygon(aes(group = item, fill = ratio))
PM10_bearing_ratio <- PM10_bearing %>% group_by(Direct) %>% summarise(n()) %>% mutate(ratio = `n()`/sum(`n()`)) %>% dplyr::select(-`n()`) %>% mutate(item = "PM10")
PM2.5_bearing_ratio <- PM2.5_bearing %>% group_by(Direct) %>% summarise(n()) %>% mutate(ratio = `n()`/sum(`n()`))  %>% dplyr::select(-`n()`) %>% mutate(item = "PM2.5")
bearing_ratio <- rbind(PM10_bearing_ratio, PM2.5_bearing_ratio)
bearing_ratio
ggplot(data = bearing_ratio ) + geom_point(aes(Direct, ratio)) + coord_polar()
ggplot(data = bearing_ratio ) + geom_point(aes(Direct, ratio, color = item)) + coord_polar()
ggplot(data = bearing_ratio ) + geom_point(aes(Direct, ratio, color = item), size = 2) + coord_polar() + theme_light()
ggplot(data = bearing_ratio ) + geom_point(aes(Direct, ratio, color = item), size = 2) + coord_polar() + geom_polygon(group = item) + theme_light()
ggplot(data = bearing_ratio ) + geom_point(aes(Direct, ratio,), size = 2) + coord_polar() + geom_polygon(group = item) + theme_light()
ggplot(data = bearing_ratio ) + geom_point(aes(Direct, ratio), size = 2) + coord_polar() + geom_polygon(aes(Direct, ratio,group = item)) + theme_light()
ggplot(data = bearing_ratio ) + geom_point(aes(Direct, ratio, color = item), size = 2) + coord_polar() + geom_polygon(aes(Direct, ratio,group = item)) + theme_light()
ggplot(data = bearing_ratio ) + geom_point(aes(Direct, ratio, color = item), size = 2) + coord_polar() + geom_polygon(aes(group = item, ratio)) + theme_light()
ggplot(data = bearing_ratio ) + geom_point(aes(Direct, ratio, color = item), size = 2) + coord_polar() + geom_polygon(aes(group = item)) + theme_light()
ggplot(data = bearing_ratio ) + geom_point(aes(Direct, ratio, color = item), size = 2) + coord_polar() + geom_polygon(aes(group = item,Direct)) + theme_light()
ggplot(data = bearing_ratio ) + geom_point(aes(Direct, ratio, color = item), size = 2) + coord_polar() + geom_polygon(aes(group = item, ratio)) + theme_light()
ggplot(data = bearing_ratio ) + geom_point(aes(Direct, ratio, color = item), size = 2) + coord_polar() + geom_polygon(aes(Direct, ratio, group = item)) + theme_light()
ggplot(data = bearing_ratio ) + geom_point(aes(Direct, ratio, color = item), size = 2) + coord_polar() + geom_polygon(aes(Direct, ratio, group = item)) + theme_light() + labs(x="" , y = "Proportion")
ggplot(data = bearing_ratio ) + geom_point(aes(Direct, ratio), size = 2) + coord_polar() + geom_polygon(aes(Direct, ratio, group = item)) + theme_light() + labs(x="" , y = "Proportion")
ggplot(data = bearing_ratio ) + geom_point(aes(Direct, ratio), size = 2) + coord_polar() + geom_polygon(aes(Direct, ratio, color = item)) + theme_light() + labs(x="" , y = "Proportion")
ggplot(data = bearing_ratio ) + geom_point(aes(Direct, ratio), size = 2) + coord_polar() + geom_polygon(aes(Direct, ratio, fill = item)) + theme_light() + labs(x="" , y = "Proportion")
ggplot(data = bearing_ratio ) + geom_point(aes(Direct, ratio), size = 2) + coord_polar() + geom_polygon(aes(Direct, ratio, group = item)) + theme_light() + labs(x="" , y = "Proportion")
ggplot(data = bearing_ratio ) + geom_point(aes(Direct, ratio), size = 2) + coord_polar() + geom_polygon(aes(Direct, ratio, group = item),fill=NA) + theme_light() + labs(x="" , y = "Proportion")
?geom_polygon
ggplot(data = bearing_ratio ) + geom_point(aes(Direct, ratio), size = 2) + coord_polar() + geom_polygon(aes(Direct, group = item), fill=NA) + theme_light() + labs(x="" , y = "Proportion")
ggplot(data = bearing_ratio ) + geom_point(aes(Direct, ratio), size = 2) + coord_polar() + geom_polygon(aes(fill=Direct, group = item), fill=NA) + theme_light() + labs(x="" , y = "Proportion")
ggplot(data = bearing_ratio ) + geom_point(aes(Direct, ratio), size = 2) + coord_polar() + geom_polygon(aes(ratio, group = item), fill=NA) + theme_light() + labs(x="" , y = "Proportion")
ggplot(data = bearing_ratio ) + geom_point(aes(Direct, ratio), size = 2) + coord_polar() + geom_polygon(aes(Direct, group = item), fill=NA) + theme_light() + labs(x="" , y = "Proportion")
ggplot(data = bearing_ratio ) + geom_point(aes(Direct, ratio), size = 2) + coord_polar() + geom_polygon(aes(Direct,ratio, group = item), fill=NA) + theme_light() + labs(x="" , y = "Proportion")
ggplot(data = bearing_ratio ) + geom_point(aes(Direct, ratio), size = 2) + coord_polar() + geom_polygon(aes(Direct,ratio, group = item, fill=NA)) + theme_light() + labs(x="" , y = "Proportion")
ggplot(data = bearing_ratio ) + geom_point(aes(Direct, ratio), size = 2) + coord_polar() + geom_polygon(aes(Direct,ratio, color = item, fill=NA)) + theme_light() + labs(x="" , y = "Proportion")
ggplot(data = bearing_ratio ) + geom_point(aes(Direct, ratio), size = 2) + coord_polar() + geom_polygon(aes(Direct,ratio, group = item), fill=NA) + theme_light() + labs(x="" , y = "Proportion")
ggplot(data = bearing_ratio ) + geom_point(aes(Direct, ratio), size = 2) + coord_polar() + geom_polygon(aes(Direct,ratio, group = item, color = item), fill=NA) + theme_light() + labs(x="" , y = "Proportion")
ggplot(data = bearing_ratio ) + geom_point(aes(Direct, ratio), size = 2) + coord_polar(start = -pi/8) + geom_polygon(aes(Direct,ratio, group = item, color = item), fill=NA) + theme_light() + labs(x=NULL , y = "Proportion")
mean_sd <- heat_island_data %>% group_by(hour, District) %>% summarise(mean(Temper), mean(PM10), mean(PM2.5), sd(Temper), sd(PM10), sd(PM2.5))
inner_join(heat_island_data,mean_sd)
std_data <- inner_join(heat_island_data,mean_sd, by = c("District","hour")) %>% mutate(Temper = (Temper - `mean(Temper)`)/`sd(Temper)` )
std_data
std_data <- inner_join(heat_island_data,mean_sd, by = c("District","hour")) %>% mutate(Temper = (Temper - `mean(Temper)`)/`sd(Temper)`, PM10 = (PM10 - `mean(PM10)`)/`sd(PM10)`, PM2.5 = (PM2.5 - `mean(PM2.5)`)/`sd(PM2.5)`)
std_data
std_data %>% ggplot() + geom_point(aes(Temper, PM10),color ="Red")
std_data %>% ggplot() + geom_point(aes(Temper, PM2.5),color ="Blue")
mod <- lm(log(price) ~ log(carat), data = diamonds)
grid <- diamonds%>% select(carat,price) %>% data_grid(carat) %>% add_predictions(mod)
mod1 <- lm(PM10 ~ Temper, data = std_data)
grid <- std_data %>% data_grid(Temper) %>% add_predictions(mod1)
ggplot(std_data) + geom_point(aes(Temper, PM10),color ="Red") + geom_line(aes(Temper,y=pred))
mod1 <- lm(PM10 ~ Temper, data = std_data)
grid <- std_data %>% data_grid(Temper) %>% add_predictions(mod1)
grid
ggplot(std_data) + geom_point(aes(Temper, PM10),color ="Red") + geom_line(aes(Temper,y=pred))
mod1 <- lm(PM10 ~ Temper, data = std_data)
grid <- std_data %>% data_grid(Temper) %>% add_predictions(mod1)
grid
ggplot(std_data) + geom_point(aes(Temper, PM10),color ="Red") + geom_line(aes(Temper,y=pred), data = grid)
mod2 <- lm(PM2.5 ~ Temper, data = std_data)
grid <- std_data %>% data_grid(Temper) %>% add_predictions(mod2)
ggplot(std_data) + geom_point(aes(Temper, PM2.5),color ="Blue") + geom_line(aes(Temper,y=pred), data = grid)
mod1 <- lm(PM10 ~ Temper, data = std_data)
grid <- std_data %>% data_grid(Temper) %>% add_predictions(mod1)
ggplot(std_data) + geom_point(aes(Temper, PM10),color ="Red") + geom_line(aes(Temper,y=pred), data = grid)
summary(mod1)
mod1 <- lm(PM10 ~ Temper, data = std_data)
grid <- std_data %>% data_grid(Temper) %>% add_predictions(mod1)
ggplot(std_data) + geom_point(aes(Temper, PM10),color ="Red") + geom_line(aes(Temper,y=pred), data = grid)
summary(mod1)
cor(PM10,Temper, data = std_data)
mod1 <- lm(PM10 ~ Temper, data = std_data)
grid <- std_data %>% data_grid(Temper) %>% add_predictions(mod1)
ggplot(std_data) + geom_point(aes(Temper, PM10),color ="Red") + geom_line(aes(Temper,y=pred), data = grid)
summary(mod1)
(0.1149)^(1/2)
mod1 <- lm(PM10 ~ Temper, data = std_data)
grid <- std_data %>% data_grid(Temper) %>% add_predictions(mod1)
ggplot(std_data) + geom_point(aes(Temper, PM10),color ="Red") + geom_line(aes(Temper,y=pred), data = grid)
summary(mod1)
cor(std_data$PM10, std_data$Temper)
(0.1149)^(1/2)
mod1 <- lm(PM10 ~ Temper, data = std_data)
grid <- std_data %>% data_grid(Temper) %>% add_predictions(mod1)
ggplot(std_data) + geom_point(aes(Temper, PM10),color ="Red") + geom_line(aes(Temper,y=pred), data = grid)
summary(mod1)
cor(std_data$PM10, std_data$Temper)
mod2 <- lm(PM2.5 ~ Temper, data = std_data)
grid <- std_data %>% data_grid(Temper) %>% add_predictions(mod2)
ggplot(std_data) + geom_point(aes(Temper, PM2.5),color ="Blue") + geom_line(aes(Temper,y=pred), data = grid)
summary(mod2)
cor(std_data$PM2.5, std_data$Temper)
mod3 <- lm(PM10 ~ PM2.5, data = std_data)
summary(mod3)
cor(std_data$PM2.5, std_data$PM10)
heat_island_data <- joined_data %>% filter(!is.na(Temper), !is.na(PM10), !is.na(PM2.5)) %>% filter(month(Measurement_date)<=2 | month(Measurement_date) == 12 ) %>% filter(hour(Measurement_date)>=3, hour(Measurement_date)<=9) %>% mutate(hour = hour(Measurement_date),year = year(Measurement_date), month = month(Measurement_date), day = day(Measurement_date))
heat_island_data
heat_island_data <- joined_data %>% filter(!is.na(Temper), !is.na(PM10), !is.na(PM2.5)) %>% filter(month(Measurement_date)<=2 | month(Measurement_date) == 12 ) %>% filter(hour(Measurement_date)>=3, hour(Measurement_date)<=9) #%>% mutate(hour = hour(Measurement_date),year = year(Measurement_date), month = month(Measurement_date), day = day(Measurement_date))
heat_island_data
mean_sd <- heat_island_data %>% group_by(Measurement.date, District) %>% summarise(mean(Temper), mean(PM10), mean(PM2.5), sd(Temper), sd(PM10), sd(PM2.5))
mean_sd <- heat_island_data %>% group_by(Measurement_date, District) %>% summarise(mean(Temper), mean(PM10), mean(PM2.5), sd(Temper), sd(PM10), sd(PM2.5))
std_data <- inner_join(heat_island_data,mean_sd, by = c("District","Measurement_date")) %>% mutate(Temper = (Temper - `mean(Temper)`)/`sd(Temper)`, PM10 = (PM10 - `mean(PM10)`)/`sd(PM10)`, PM2.5 = (PM2.5 - `mean(PM2.5)`)/`sd(PM2.5)`)
mod1 <- lm(PM10 ~ Temper, data = std_data)
grid <- std_data %>% data_grid(Temper) %>% add_predictions(mod1)
ggplot(std_data) + geom_point(aes(Temper, PM10),color ="Red") + geom_line(aes(Temper,y=pred), data = grid)
summary(mod1)
cor(std_data$PM10, std_data$Temper)
std_data <- inner_join(heat_island_data,mean_sd, by = c("District","Measurement_date")) %>% mutate(Temper = (Temper - `mean(Temper)`)/`sd(Temper)`, PM10 = (PM10 - `mean(PM10)`)/`sd(PM10)`, PM2.5 = (PM2.5 - `mean(PM2.5)`)/`sd(PM2.5)`)
std_data
std_data <- inner_join(heat_island_data,mean_sd, by = c("District","Measurement_date")) %>% mutate(Temper = (Temper - `mean(Temper)`)/`sd(Temper)`, PM10 = (PM10 - `mean(PM10)`)/`sd(PM10)`, PM2.5 = (PM2.5 - `mean(PM2.5)`)/`sd(PM2.5)`)
std_data
mean_sd <- heat_island_data %>% group_by(Measurement_date, District) %>% summarise(mean(Temper), mean(PM10), mean(PM2.5), sd(Temper), sd(PM10), sd(PM2.5))
mean_sd
mean_sd <- heat_island_data %>% group_by(Measurement_date) %>% summarise(mean(Temper), mean(PM10), mean(PM2.5), sd(Temper), sd(PM10), sd(PM2.5))
mean_sd
std_data <- inner_join(heat_island_data, mean_sd, by = "Measurement_date")) %>% mutate(Temper = (Temper - `mean(Temper)`)/`sd(Temper)`, PM10 = (PM10 - `mean(PM10)`)/`sd(PM10)`, PM2.5 = (PM2.5 - `mean(PM2.5)`)/`sd(PM2.5)`)
std_data
std_data <- inner_join(heat_island_data, mean_sd, by = "Measurement_date") %>% mutate(Temper = (Temper - `mean(Temper)`)/`sd(Temper)`, PM10 = (PM10 - `mean(PM10)`)/`sd(PM10)`, PM2.5 = (PM2.5 - `mean(PM2.5)`)/`sd(PM2.5)`)
std_data
mod1 <- lm(PM10 ~ Temper, data = std_data)
grid <- std_data %>% data_grid(Temper) %>% add_predictions(mod1)
ggplot(std_data) + geom_point(aes(Temper, PM10),color ="Red") + geom_line(aes(Temper,y=pred), data = grid)
summary(mod1)
cor(std_data$PM10, std_data$Temper)
std_data <- inner_join(heat_island_data, mean_sd, by = "Measurement_date") %>% mutate(Temper = (Temper - `mean(Temper)`)/`sd(Temper)`, PM10 = (PM10 - `mean(PM10)`)/`sd(PM10)`, PM2.5 = (PM2.5 - `mean(PM2.5)`)/`sd(PM2.5)`)
std_data %>% filter(District == "Gwanak-gu")
mod2 <- lm(PM2.5 ~ Temper, data = std_data)
grid <- std_data %>% data_grid(Temper) %>% add_predictions(mod2)
ggplot(std_data) + geom_point(aes(Temper, PM2.5),color ="Blue") + geom_line(aes(Temper,y=pred), data = grid)
summary(mod2)
cor(std_data$PM2.5, std_data$Temper)
mod3 <- lm(PM10 ~ PM2.5, data = std_data)
summary(mod3)
cor(std_data$PM2.5, std_data$PM10)
heat_island_data <- joined_data %>% filter(!is.na(Temper), !is.na(PM10), !is.na(PM2.5)) %>% filter(month(Measurement_date)<=2 | month(Measurement_date) == 12 ) %>% filter(hour(Measurement_date)>=3, hour(Measurement_date)<=9)
heat_island_data %>% group_by(District) %>% summarise(mean(Temper))
heat_island_data <- joined_data %>% filter(!is.na(Temper), !is.na(PM10), !is.na(PM2.5)) %>% filter(month(Measurement_date)<=2 | month(Measurement_date) == 12 ) %>% filter(hour(Measurement_date)>=3, hour(Measurement_date)<=9)
heat_island_data %>% group_by(District) %>% summarise(mean(Temper)) %>% arrange(desc(`mean(Temper)`)
heat_island_data <- joined_data %>% filter(!is.na(Temper), !is.na(PM10), !is.na(PM2.5)) %>% filter(month(Measurement_date)<=2 | month(Measurement_date) == 12 ) %>% filter(hour(Measurement_date)>=3, hour(Measurement_date)<=9)
heat_island_data %>% group_by(District) %>% summarise(mean(Temper)) %>% arrange(desc(`mean(Temper)`))
heat_island_data %>% group_by(District) %>% summarise(mean(Temper)) %>% arrange(desc(`mean(Temper)`))
heat_island_data %>% group_by(District) %>% summarise(mean(Temper)) %>% arrange(desc(`mean(Temper)`))
mean_sd_1 <- heat_island_data %>%filter(District == c("Seongdong-gu" ,"Yeongdeungpo-gu")) group_by(Measurement_date) %>% summarise(mean(Temper), mean(PM10), mean(PM2.5), sd(Temper), sd(PM10), sd(PM2.5))
mean_sd_1 <- heat_island_data %>%filter(District == c("Seongdong-gu" ,"Yeongdeungpo-gu")) %>% group_by(Measurement_date) %>% summarise(mean(Temper), mean(PM10), mean(PM2.5), sd(Temper), sd(PM10), sd(PM2.5))
mean_sd_1 <- heat_island_data %>%filter(District == c("Seongdong-gu" ,"Yeongdeungpo-gu")) %>% group_by(Measurement_date) %>% summarise(mean(Temper), mean(PM10), mean(PM2.5), sd(Temper), sd(PM10), sd(PM2.5))
mean_sd_1
heat_island_data_1 <-  heat_island_data %>% filter(District == "Seongdong-gu" | District == "Yeongdeungpo-gu" | District =="Songpa-gu"| District =="Geumcheon-gu" | District =="Dongdaemun-gu" | District =="Yangcheon-gu" | District == "Gangnam-gu"| District =="Yongsan-gu" | District =="Gwangjin-gu" | District =="Jungnang-gu	")
mean_sd_1 <- heat_island_data_1 %>% group_by(Measurement_date) %>% summarise(mean(Temper), mean(PM10), mean(PM2.5), sd(Temper), sd(PM10), sd(PM2.5))
heat_island_data_1 <-  heat_island_data %>% filter(District == "Seongdong-gu" | District == "Yeongdeungpo-gu" | District =="Songpa-gu"| District =="Geumcheon-gu" | District =="Dongdaemun-gu" | District =="Yangcheon-gu" | District == "Gangnam-gu"| District =="Yongsan-gu" | District =="Gwangjin-gu" | District =="Jungnang-gu	")
heat_island_data_1
mean_sd_1 <- heat_island_data_1 %>% group_by(Measurement_date) %>% summarise(mean(Temper), mean(PM10), mean(PM2.5), sd(Temper), sd(PM10), sd(PM2.5))
heat_island_data_1 <-  heat_island_data %>% filter(District == "Seongdong-gu" | District == "Yeongdeungpo-gu" | District =="Songpa-gu"| District =="Geumcheon-gu" | District =="Dongdaemun-gu" | District =="Yangcheon-gu" | District == "Gangnam-gu"| District =="Yongsan-gu" | District =="Gwangjin-gu" | District =="Jungnang-gu	")
mean_sd_1 <- heat_island_data_1 %>% group_by(Measurement_date) %>% summarise(mean(Temper), mean(PM10), mean(PM2.5), sd(Temper), sd(PM10), sd(PM2.5))
std_data_1 <- inner_join(heat_island_data, mean_sd_1, by = "Measurement_date") %>% mutate(Temper = (Temper - `mean(Temper)`)/`sd(Temper)`, PM10 = (PM10 - `mean(PM10)`)/`sd(PM10)`, PM2.5 = (PM2.5 - `mean(PM2.5)`)/`sd(PM2.5)`)
mod1_1 <- lm(PM10 ~ Temper, data = std_data_1)
grid_1 <- std_data_1 %>% data_grid(Temper) %>% add_predictions(mod1_1)
ggplot(std_data_1) + geom_point(aes(Temper, PM10),color ="Red") + geom_line(aes(Temper,y=pred), data = grid_1)
summary(mod1_1)
cor(std_data_1$PM10, std_data_1$Temper)
mod1_1 <- lm(PM2.5 ~ Temper, data = std_data_1)
grid_1 <- std_data_1 %>% data_grid(Temper) %>% add_predictions(mod1_1)
ggplot(std_data_1) + geom_point(aes(Temper, PM2.5),color ="Red") + geom_line(aes(Temper,y=pred), data = grid_1)
summary(mod1_1)
cor(std_data_1$PM10, std_data_1$Temper)
heat_island_data_1 <-  heat_island_data %>% filter(District == "Seongdong-gu" | District == "Yeongdeungpo-gu" | District =="Songpa-gu"| District =="Geumcheon-gu" | District =="Dongdaemun-gu" | District =="Yangcheon-gu" | District == "Gangnam-gu")
mean_sd_1 <- heat_island_data_1 %>% group_by(Measurement_date) %>% summarise(mean(Temper), mean(PM10), mean(PM2.5), sd(Temper), sd(PM10), sd(PM2.5))
std_data_1 <- inner_join(heat_island_data, mean_sd_1, by = "Measurement_date") %>% mutate(Temper = (Temper - `mean(Temper)`)/`sd(Temper)`, PM10 = (PM10 - `mean(PM10)`)/`sd(PM10)`, PM2.5 = (PM2.5 - `mean(PM2.5)`)/`sd(PM2.5)`)
mod1_1 <- lm(PM2.5 ~ Temper, data = std_data_1)
grid_1 <- std_data_1 %>% data_grid(Temper) %>% add_predictions(mod1_1)
ggplot(std_data_1) + geom_point(aes(Temper, PM2.5),color ="Red") + geom_line(aes(Temper,y=pred), data = grid_1)
summary(mod1_1)
cor(std_data_1$PM10, std_data_1$Temper)
mod1_1 <- lm(PM2.5 ~ Temper, data = std_data_1)
grid_1 <- std_data_1 %>% data_grid(Temper) %>% add_predictions(mod1_1)
ggplot(std_data_1) + geom_point(aes(Temper, PM2.5),color ="Red") + geom_line(aes(Temper,y=pred), data = grid_1)
summary(mod1_1)
cor(std_data_1$PM2.5, std_data_1$Temper)
heat_island_data_1 <-  heat_island_data %>% filter(District == "Seongdong-gu" | District == "Yeongdeungpo-gu" | District =="Songpa-gu"| District =="Geumcheon-gu" | District =="Dongdaemun-gu")
mean_sd_1 <- heat_island_data_1 %>% group_by(Measurement_date) %>% summarise(mean(Temper), mean(PM10), mean(PM2.5), sd(Temper), sd(PM10), sd(PM2.5))
std_data_1 <- inner_join(heat_island_data, mean_sd_1, by = "Measurement_date") %>% mutate(Temper = (Temper - `mean(Temper)`)/`sd(Temper)`, PM10 = (PM10 - `mean(PM10)`)/`sd(PM10)`, PM2.5 = (PM2.5 - `mean(PM2.5)`)/`sd(PM2.5)`)
mod1_1 <- lm(PM2.5 ~ Temper, data = std_data_1)
grid_1 <- std_data_1 %>% data_grid(Temper) %>% add_predictions(mod1_1)
ggplot(std_data_1) + geom_point(aes(Temper, PM2.5),color ="Red") + geom_line(aes(Temper,y=pred), data = grid_1)
summary(mod1_1)
cor(std_data_1$PM2.5, std_data_1$Temper)
heat_island_data_1 <-  heat_island_data %>% filter(District == "Seongdong-gu" | District == "Yeongdeungpo-gu" | District =="Songpa-gu" )
mean_sd_1 <- heat_island_data_1 %>% group_by(Measurement_date) %>% summarise(mean(Temper), mean(PM10), mean(PM2.5), sd(Temper), sd(PM10), sd(PM2.5))
std_data_1 <- inner_join(heat_island_data, mean_sd_1, by = "Measurement_date") %>% mutate(Temper = (Temper - `mean(Temper)`)/`sd(Temper)`, PM10 = (PM10 - `mean(PM10)`)/`sd(PM10)`, PM2.5 = (PM2.5 - `mean(PM2.5)`)/`sd(PM2.5)`)
mod1_1 <- lm(PM2.5 ~ Temper, data = std_data_1)
grid_1 <- std_data_1 %>% data_grid(Temper) %>% add_predictions(mod1_1)
ggplot(std_data_1) + geom_point(aes(Temper, PM2.5),color ="Red") + geom_line(aes(Temper,y=pred), data = grid_1)
summary(mod1_1)
cor(std_data_1$PM2.5, std_data_1$Temper)
std_data_1 <- inner_join(heat_island_data, mean_sd_1, by = "Measurement_date") %>% mutate(Temper = (Temper - `mean(Temper)`)/`sd(Temper)`, PM10 = (PM10 - `mean(PM10)`)/`sd(PM10)`, PM2.5 = (PM2.5 - `mean(PM2.5)`)/`sd(PM2.5)`)
mod1_1 <- lm(PM2.5 ~ Temper, data = std_data_1)
grid_1 <- std_data_1 %>% data_grid(Temper) %>% add_predictions(mod1_1)
ggplot(std_data_1) + geom_point(aes(Temper, PM2.5),color ="Red") + geom_line(aes(Temper,y=pred), data = grid_1)
summary(mod1_1)
cor(std_data_1$PM2.5, std_data_1$Temper)
